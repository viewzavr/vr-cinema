<!DOCTYPE html>
<html>
  <script src="./lib/viewzavr-system-a/lib/viewlang/code/depends/jquery-2.1.4.js"></script>

  <script src="./lib/viewzavr-system-a/lib/viewlang/code//depends/qmlweb/src/parser.js"></script>
  <script src="./lib/viewzavr-system-a/lib/viewlang/code//depends/qmlweb/src/process.js"></script>
  <script src="./lib/viewzavr-system-a/lib/viewlang/code//depends/qmlweb/src/import.js"></script>
  <script src="./lib/viewzavr-system-a/lib/viewlang/code//depends/qmlweb/src/qtcore.js"></script>

  <script src="./lib/viewzavr-system-a/lib/viewlang/code//base.js"></script>
<head>
</head>
<body>
  <div id="qmlSpace">
      target space for qml...
  </div>
  <style>
  #qmlSpace {
    width: 100vw !important;
    bottom: 0px !important;
    z-index: 10000;
  }
  .viewlang-canvas {
    width: 100%; height: 100%;
    margin: 0; padding: 0; display: block; left: 0px; top: 0px; position: absolute;
  }
  body { margin: 0; }
  </style>

  <script src="./lib/viewzavr-system-a/lib/viewlang/code//threejs_driver/init.js"></script>

  <script type="module">

    ///////////////////////////// qmlweb and viewlang (required for viewzavr-system-a implementation)
    
    import * as Viewlang from "./lib/viewzavr-system-a/lib/viewlang/code/embed2/init.js"
    window.qmlEngine = new QMLEngine( document.getElementById( "qmlSpace" ) );
    Viewlang.setup_qmlweb( qmlEngine );
    
    ///////////////////////////// viewzavr
    
    import * as Viewzavr from "./lib/viewzavr-system-a/lib/viewzavr-core/init.js";

    var vz = Viewzavr.create();
    // window.vz = vz;
    
    //////////////////////////// player
    
    import * as Player from "./lib/viewzavr-system-a/player/init.js";
    var vzPlayer = Player.create( vz, qmlEngine );
    window.vzPlayer = vzPlayer;
    
    //////////////////////////// graphical api
    import * as VisAPI from "./lib/viewzavr-system-a/graphical-api/init.js";
    VisAPI.setup( vz );

    //////////////////////////// library-one
    import * as lib1 from "./lib/viewzavr-system-a/lib/library-one/init.js";
    lib1.setup( vz, vzPlayer );
    
    //////////////////////////// required packages
    // we need almost always that package
    //var q0 = vzPlayer.loadPackage( ["vis-comps", vz.getDir( import.meta.url ) + "/views/list.txt", vz.getDir( import.meta.url ) + "/views/list.txt"]);
    //var q0 = vzPlayer.loadAppPackage( vz.getDir( import.meta.url ) + "/list.txt", "" );

/*
    var q0 = vzPlayer.loadApp( vz.getDir( import.meta.url ) + "/list.txt" );
    q0.then( function() {
       vzPlayer.feature( "hash-settings auto-load-settings auto-save-settings auto-save-screenshot datapath-from-url commands-socket file-progress");
    });
*/    

  /*
    q0.then( function() {
       vzPlayer.loadPackage( vz.getDir( import.meta.url ) + "/app_features.txt" ); 
    });
    */    

    //vzPlayer.loadPackage( vz.getDir( import.meta.url ) + "/app_features.txt" );
    //vzPlayer.feature( "state-in-hash")
    //vzPlayer.load_features( vz.getDir( import.meta.url ) + "/app_features.txt" )

    /*
    import F1 from "./auto-load-settings.js";
    import F2 from "./hash-settings.js";
    import F3 from "./auto-save-settings.js";
    import F4 from "./commands-socket.js";
    import F5 from "./file-progress.js";
    import F6 from "./datapath-from-url.js";

    q0.then( function() {
       F1(vz); F2(vz); F3(vz); F4(vz); F5(vz); F6(vz);
    });    
    */

    /*
    import * as FE from "./features.js";

    var q0 = vzPlayer.loadApp( vz.getDir( import.meta.url ) + "/list.txt" );
    q0.then( function() {
      FE.auto_load_settings( vzPlayer );
      FE.hash_settings( vzPlayer );
      FE.auto_save_settings( vzPlayer );
      FE.auto_save_screenshot( vzPlayer );
      FE.show_file_progress( vzPlayer );
      FE.commands_socket( vzPlayer );
      FE.datapath_from_url( vzPlayer );
    });
    */

    ////////////////////////////////////////////////

    var q0 = vzPlayer.loadApp( vz.getDir( import.meta.url ) + "/list.txt" );
    q0.then( function() {
       vzPlayer.feature( 
          `hash-settings
           auto-load-settings
           auto-save-settings
           auto-save-screenshot
           datapath-from-url
           commands-socket
           show-file-progress`);
    });

  </script>

</body>
